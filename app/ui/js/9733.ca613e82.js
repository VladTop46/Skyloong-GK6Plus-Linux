(self["webpackChunkkeyboard_driver"]=self["webpackChunkkeyboard_driver"]||[]).push([[9733],{32703:function(a,t,e){t=a.exports=e(54765)(!1),t.push([a.id,"\n.macro-list[data-v-23cf8032] {\r\n  display: flex;\r\n  flex-direction: row;\r\n  flex-wrap: wrap;\r\n  align-content: flex-start;\r\n  width: 100%;\r\n  height: 400px;\r\n  list-style: none;\r\n  margin: 0;\r\n  padding: 0;\r\n  overflow: auto;\n}\n.layout .sidebar[data-v-23cf8032] {\r\n  width: 100%;\r\n  height: 420px;\r\n  min-width: 100%;\n}\n.macro-list li[data-v-23cf8032] {\r\n  text-align: center;\r\n  align-content: flex-start;\r\n  color: #ababab;\r\n  flex-grow: 0;\r\n  /*  flex-shrink: 3;*/\r\n  flex-basis: 100px;\r\n  list-style: none;\r\n  font-size: 10px/1.5;\r\n  width: 16%;\r\n  margin: 1% 1% 1% 1%;\n}\nul li img[data-v-23cf8032] {\r\n  max-width: 100%;\n}\n.macro-list li.select img[data-v-23cf8032] {\r\n  box-shadow: rgb(64, 158, 255) 0px 0px 5px 5px;\n}\n.macro-list li.select p[data-v-23cf8032] {\r\n  color: #00c2ff;\n}\n.macro-edit-btn[data-v-23cf8032] {\r\n  padding: 0.4rem 0;\n}\n.pop-form .el-form-item[data-v-23cf8032] {\r\n  margin: 0px;\n}\n.macro-edit-box .macro-data-tb .el-input--mini .el-input__inner[data-v-23cf8032] {\r\n  height: 20px;\r\n  line-height: 20px;\n}\n.macro-edit-box .macro-data-tb .el-button--mini[data-v-23cf8032] {\r\n  padding: 2px 4px;\n}\n.el-button[data-v-23cf8032],\r\n.el-table[data-v-23cf8032] {\r\n  color: rgb(219, 219, 219);\n}\n[data-v-23cf8032] .el-table__empty-block {\r\n  height: 50% !important;\n}\n.btn-danger[data-v-23cf8032] {\r\n  color: #f56c6c;\n}\n.btn-danger .el-button[data-v-23cf8032] {\r\n  color: red;\n}\n.editting[data-v-23cf8032] {\r\n  background-color: #00c2ff;\n}\r\n",""])},39733:function(a,t,e){"use strict";e.r(t),e.d(t,{default:function(){return d}});e(25276);var o=function(){var a=this,t=a._self._c;return t("el-row",{staticClass:"xs:text-xs sm:text-sm md:text-md lg:text-lg xl:text-xl 2xl:text-2xl 3xl:text-3xl"},[t("el-col",{attrs:{span:24}},[t("el-row",{style:{height:a.lay_h_macros}},[t("el-col",{attrs:{span:24}},[t("el-row",[t("el-col",{style:{height:a.lay_h_macros+"px",padding:".4rem"},attrs:{span:6}},[t("el-card",{staticStyle:{height:"100%","box-sizing":"content-box"},attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("svg-icon",{staticClass:"header-icon",attrs:{name:"cate"}}),a._v("\n                 \n                "),t("span",[a._v(a._s(a.$t("macro.macro_cate")))]),t("el-popover",{attrs:{effect:"dark",placement:"right",trigger:"click"}},[t("el-form",{staticClass:"pop-form",attrs:{inline:!0},nativeOn:{submit:function(a){a.preventDefault()}}},[t("el-form-item",[t("el-input",{attrs:{maxlength:18,placeholder:a.$t("macro.macro_package"),clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.addMacroCate.apply(null,arguments)}},model:{value:a.newmacrocate.Name,callback:function(t){a.$set(a.newmacrocate,"Name",t)},expression:"newmacrocate.Name"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-plus"},on:{click:a.addMacroCate}},[a._v(a._s(a.$t("common.confirm"))+"\n                      ")])],1)],1),t("span",{staticClass:"el-icon-plus",staticStyle:{float:"right",color:"#00c2ff",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"})],1)],1),t("el-table",{ref:"macrocatetable",attrs:{data:a.macrolist,"empty-text":a.$t("common.no_data"),height:a.lay_h_macros-60+"px","row-class-name":a.tableRowClassName,"show-header":!1,"highlight-current-row":"","tooltip-effect":"dark"},on:{"row-click":a.handleRowChange}},[t("el-table-column",{attrs:{label:"Date",prop:"Icon",width:"60px"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-image",{staticStyle:{width:"2rem",height:"2rem"},attrs:{src:a.APPCFG.res[e.row.IconSrc],fit:"cover"}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"2rem"}})])])]}}])}),t("el-table-column",{attrs:{align:"left",label:"Name",prop:"Name","show-overflow-tooltip":""},scopedSlots:a._u([{key:"default",fn:function(e){e.row;var o=e.$index;return a._l(a.macrolist,(function(e,r){return o===r&&e&&e.Name?t("span",{key:r},[t("el-input",{attrs:{placeholder:"Enter Name"},on:{change:function(t){return a.handleNameChange(e,t,o)}},model:{value:e.Name,callback:function(t){a.$set(e,"Name",t)},expression:"CateMacro.Name"}})],1):o!==r||e&&e.Name?a._e():t("span",[a._v("\n                      No Cate\n                    ")])}))}}])}),t("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"60px"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{staticStyle:{color:"red"},attrs:{icon:"el-icon-delete",type:"text"},on:{click:a.deleteMacroCate}})]}}])})],1)],1)],1),t("el-col",{style:{height:a.lay_h_macros+"px",padding:".4rem 1rem"},attrs:{span:18}},[t("main",{staticClass:"content"},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-breadcrumb",{staticStyle:{"line-height":"28px",height:"28px"},attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[a._v(a._s(a.$t("macro.macro_mgr")))]),"No Macro Cate"!==a.currentMacroName?t("el-breadcrumb-item",{staticStyle:{color:"#00c2ff"}},[a._v("\n                      "+a._s(a.currentMacroName)+"\n                    ")]):a._e()],1)],1),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{float:"right"}},[t("el-popover",{staticStyle:{"margin-right":"10px"},attrs:{placement:"left",trigger:"click"}},[t("el-form",{staticClass:"pop-form",attrs:{inline:!0},nativeOn:{submit:function(a){a.preventDefault()}}},[t("el-form-item",[t("el-input",{attrs:{maxlength:12,placeholder:a.$t("macro.macro_item"),autofocus:"true",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.addMacro.apply(null,arguments)}},model:{value:a.newmacro.Name,callback:function(t){a.$set(a.newmacro,"Name",t)},expression:"newmacro.Name"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-plus"},on:{click:a.addMacro}},[a._v("\n                            "+a._s(a.$t("common.confirm"))+"\n                          ")])],1)],1),t("el-button",{attrs:{slot:"reference",icon:"el-icon-plus"},slot:"reference"})],1),t("el-button",{attrs:{icon:"el-icon-copy-document"},on:{click:a.copyMacro}}),t("el-button",{attrs:{icon:"el-icon-delete",type:"danger"},on:{click:a.deleteMacro}}),t("el-tooltip",{attrs:{placement:"top","hide-after":500}},[t("div",{attrs:{slot:"content"},slot:"content"},[a._v(a._s(a.$t("macro.macro_import")))]),t("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:a.importMacroFile}})],1),t("el-tooltip",{attrs:{placement:"top","hide-after":500}},[t("div",{attrs:{slot:"content"},slot:"content"},[a._v(a._s(a.$t("macro.macro_export")))]),t("el-button",{attrs:{icon:"el-icon-download"},on:{click:a.exportMacroFile}})],1)],1)])],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("ul",{staticClass:"macro-list",style:{height:a.lay_h_macros-60+"px"}},a._l(a.submacros,(function(e,o){return t("li",{key:e.index,class:{select:a.isSelectedMacro(e)},attrs:{"data-guid":e.GUID},on:{click:function(t){return a.handleSelectMacro(o)}}},[t("img",{staticClass:"no-display-block",staticStyle:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},attrs:{src:a.APPCFG.res.macro_icon_default}}),t("p",{staticStyle:{margin:"0",padding:"0"}},[a._v("\n                        "+a._s(e.Name||a.$t("macro.macro_unselect"))+"\n                      ")])])})),0)])],1)],1)])],1)],1)],1),t("el-row",{staticClass:"macro-edit-box",style:{height:a.lay_h_macro_editer+"px",background:"rgba(20,20,20,.8)",padding:".4rem 1rem"}},[t("el-col",{attrs:{span:6}},[t("el-row",[t("el-form",{attrs:{"label-position":"top"}},[t("el-form-item",{attrs:{label:a.$t("macro.macro_name")}},[t("el-input",{staticStyle:{width:"80%"},on:{change:a.changeMacroName},model:{value:a.macroname,callback:function(t){a.macroname=t},expression:"macroname"}})],1),t("el-form-item",{attrs:{label:a.$t("macro.macro_delay_mode")}},[t("el-radio",{attrs:{label:1},model:{value:a.macro_delay_type,callback:function(t){a.macro_delay_type=t},expression:"macro_delay_type"}},[a._v(a._s(a.$t("macro.macro_delay_record_time"))+"\n              ")]),t("br"),t("el-radio",{attrs:{label:2},model:{value:a.macro_delay_type,callback:function(t){a.macro_delay_type=t},expression:"macro_delay_type"}},[a._v(a._s(a.$t("macro.macro_delay_mini_time"))+"\n              ")]),t("br"),t("el-radio",{attrs:{label:3},model:{value:a.macro_delay_type,callback:function(t){a.macro_delay_type=t},expression:"macro_delay_type"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.macro_delay_time,expression:"macro_delay_time"}],staticClass:"edit-cell mini",domProps:{value:a.macro_delay_time},on:{input:function(t){t.target.composing||(a.macro_delay_time=t.target.value)}}}),a._v("\n                "+a._s(a.$t("macro.macro_delay_n_time"))+"\n              ")])],1)],1)],1)],1),t("el-col",{staticStyle:{background:"#151515","text-align":"center",height:"100%"},attrs:{span:2,direction:"horizontal"}},[t("el-row",{staticClass:"macro-edit-btn"},[t("el-tooltip",{attrs:{content:a.isrecording?a.$t("macro.macro_record_stop"):a.$t("macro.macro_record"),effect:"dark",placement:"left"}},[t("el-button",{attrs:{icon:a.recordingicon,type:a.recordingtype,onfocus:"this.blur()"},on:{click:a.switchMacroRecord},nativeOn:{mouseenter:function(t){return a.recordBtnEnter(t)},mouseleave:function(t){return a.recordBtnLeave(t)}}})],1)],1),t("el-row",{class:{"macro-edit-btn":!0,"btn-danger":a.isMacroEditing}},[t("el-tooltip",{attrs:{content:a.$t("macro.macro_edit"),effect:"dark",placement:"left"}},[t("el-button",{attrs:{icon:"el-icon-edit"},on:{click:a.editMacroData}})],1)],1),t("el-row",{staticClass:"macro-edit-btn"},[t("el-tooltip",{attrs:{content:a.$t("macro.macro_save"),effect:"dark",placement:"left"}},[t("el-button",{class:{"btn-breath":a.ismacrodatachange&&!a.isrecording},attrs:{disabled:!a.isMacroEditing||a.isrecording,icon:"el-icon-check"},on:{click:a.saveMacroData}})],1)],1),t("el-row",{staticClass:"macro-edit-btn"},[t("el-tooltip",{attrs:{content:a.$t("macro.macro_revoke"),effect:"dark",placement:"left"}},[t("el-button",{attrs:{icon:"el-icon-back"},on:{click:a.cancelMacroData}})],1)],1)],1),t("el-col",{attrs:{span:16}},[t("el-row",[t("el-table",{ref:"macrodatatable",staticClass:"macro-data-tb",attrs:{data:a.macrodata.TaskList||[],"empty-text":a.$t("common.no_data"),height:a.lay_h_macro_editer-20+"px","max-height":200,"row-class-name":a.tableMacroRowClassName,"show-header":!1,"highlight-current-row":""}},[t("el-table-column",{attrs:{label:"Type",prop:"taskName",width:"40"},scopedSlots:a._u([{key:"default",fn:function(e){return["KeyUp"==e.row.taskName?t("svg-icon",{attrs:{name:"keyup"}}):a._e(),"KeyDown"==e.row.taskName?t("svg-icon",{attrs:{name:"keydown"}}):a._e(),"LeftUp"==e.row.taskName||"LeftDown"==e.row.taskName?t("svg-icon",{attrs:{name:"mouse-left"}}):a._e(),"RightUp"==e.row.taskName||"RightDown"==e.row.taskName?t("svg-icon",{attrs:{name:"mouse-right"}}):a._e(),"MiddleClick"==e.row.taskName?t("svg-icon",{attrs:{name:"key-mouse-mid"}}):a._e(),"Delay"==e.row.taskName?t("svg-icon",{attrs:{name:"delay"}}):a._e()]}}])}),t("el-table-column",{attrs:{label:"Name",prop:"taskValue",width:"160"},scopedSlots:a._u([{key:"default",fn:function(e){return[""==e.row.taskValue&&"Delay"!=e.row.taskName?t("p",[a._v("\n                  "+a._s(e.row.taskName)+"\n                ")]):"Delay"==e.row.taskName?t("p",[a.isMacroEditing?t("el-input",{staticStyle:{width:"80px"},nativeOn:{keyup:function(t){return a.formatDelay(t)}},model:{value:e.row.taskValue,callback:function(t){a.$set(e.row,"taskValue",t)},expression:"scope.row.taskValue"}}):t("span",[a._v(a._s(e.row.taskValue))]),a._v("\n                  ms\n                ")],1):t("span",{class:{editting:a.editidx.indexOf(e.$index)>-1}},[a._v(a._s(e.row.taskValue))])]}}])}),a.isMacroEditing?t("el-table-column",{attrs:{label:"Name",prop:"taskValue"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{staticClass:"btn-danger",attrs:{icon:"el-icon-delete",size:"mini",type:"text"},on:{click:function(t){return a.delMacroItem(e.$index)}}}),"Delay"!=e.row.taskName&&""!=e.row.taskValue?t("el-button",{staticStyle:{color:"#00c2ff"},attrs:{icon:"el-icon-edit",size:"mini",type:"text"},on:{click:function(t){return a.editMacroItem(e.$index)}}}):a._e()]}}],null,!1,1123724514)}):a._e(),t("el-table-column",{attrs:{label:"Name"}})],1)],1)],1)],1)],1),t("el-dialog",{attrs:{"before-close":a.handleCloseDialog,"show-close":a.dialog.isshowclose,visible:a.dialog.visible,center:"",width:"30%"},on:{"update:visible":function(t){return a.$set(a.dialog,"visible",t)}}},[t("p",{attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"el-icon-warning"}),a._v("\n      "+a._s(a.dialog.title)+"\n    ")]),t("span",[a._v(a._s(a.dialog.content))]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{icon:"el-icon-back"},on:{click:function(t){a.dialog.visible=!1}}},[a._v(a._s(a.$t("common.cancel")))]),t("el-button",{attrs:{icon:"el-icon-check",type:"primary"},on:{click:a.handleConfirm}},[a._v(a._s(a.$t("common.confirm")))])],1)])],1)},r=[],c=(e(26910),e(54554),e(26099),e(84864),e(27495),e(38781),e(23500),e(48782),document.getElementById("mainbox").offsetHeight),s=document.getElementById("mainbox").offsetWidth,i={data(){return{resdir:CMS.resdir,mainh:c,mainw:s,macrolist:CMS.macros,macrocatesel:0,macrosel:0,submacros:[],search:"",macro_delay_type:1,macro_delay_time:1e3,mode:"new",isrecording:!1,recordingicon:"el-icon-video-play",recordingtype:"default",newmacrocate:{Name:"",Type:1,GUID:"",Icon:"defaultcate.png",IconSrc:"macro_icon_default_folder",Data:[]},newmacro:{Name:"",Type:0,GUID:"",Icon:"default.png"},macrodata:{MacroName:"",GUID:"",TaskList:[]},dialog:{visible:!1,isshowclose:!1,title:"",content:"",dtype:0},macrodataorg:{},ismacrodatachange:!1,isMacroEditing:!1,editidx:[]}},mounted:function(){CMS.macros&&CMS.macros.length>0&&CMS.macros[0].Data?(this.$refs.macrocatetable.setCurrentRow(CMS.macros[0]),this.submacros=CMS.macros[0].Data,this.handleSelectMacro(0)):(this.$refs.macrocatetable.setCurrentRow(null),this.submacros=[],this.handleSelectMacro(null),console.warn("CMS.macros is empty or not defined, or CMS.macros[0].Data is undefined."))},destroyed(){var a={infos:[]};this.macrolist.forEach((function(t,e){a.infos.push({})}))},computed:{lay_h_macros:function(){return this.mainh/3*2},lay_h_macro_editer:function(){return this.mainh/3*2},currentMacroName(){return this.macrolist[this.macrocatesel]&&this.macrolist[this.macrocatesel].Name?this.macrolist[this.macrocatesel].Name:"No Macro Cate"},macroname:{get(){var a=this.macrolist[this.macrocatesel],t=a?a.Data:[],e=t.length>0?t[this.macrosel]:null;return e&&e.Name?e.Name:this.$t("macro.macro_unselect")},set(a){var t=this;if(this.macrolist.length>0&&this.macrolist[this.macrocatesel].Data.length>0){var e=this.macrolist[this.macrocatesel].Data[this.macrosel];if(e){var o=this.isDuplicateMacroName(a,this.macrocatesel,this.macrosel);if(o)return void this.alertInfo(this.$t("macro.macro_cate_already_exist"),"warning",1e3);this.$set(e,"Name",a),window.writeMacroList(this.macrolist,(function(a){t.alertInfo(t.$t("macro.macro_rename")+t.$t("common.success"),"success",500)}))}else console.warn("No macro selected. Cannot change macro name.")}}}},watch:{currentMacroName(a){"No Macro Cate"===a&&this.navigateToRoot()},macrocatesel(a,t){var e=this;e.macrolist[a]&&0===e.macrolist[a].Data.length?e.macrodata.TaskList=[]:e.handleSelectMacro(0)},macrodata:{handler(a,t){if(this.isrecording){var e=this.$refs.macrodatatable.$el.querySelector(".el-table__body-wrapper");e.scrollHeight,setTimeout((function(){e.scrollTop=e.scrollHeight}),200)}this.isMacroEditing&&(JSON.stringify(a.TaskList)==JSON.stringify(this.macrodataorg.TaskList)?this.ismacrodatachange=!1:this.ismacrodatachange=!0)},deep:!0}},methods:{isDuplicateMacroName(a,t,e){var o=this.macrolist[t];if(o&&o.Data)for(var r=0;r<o.Data.length;r++)if(r!==e&&o.Data[r].Name===a)return!0;return!1},handleNameChange(a,t,e){var o=this;if(a){if(!t)return a.Name=`Cate ${e}`;a.Name=t,window.writeMacroList(this.macrolist,(function(a){o.alertInfo(o.$t("macro.macro_rename")+o.$t("common.success"),"success",500)}))}},isMacroNameExists(a){return this.macrolist.some((function(t){return t.Name===a}))},navigateToRoot(){this.macrocatesel=null},isSelectedMacro(a){var t=this.macrolist[this.macrocatesel],e=t?t.Data[this.macrosel]:null;return!!e&&a.GUID===e.GUID},resetTableHeight(a){a.width,a.height;document.getElementsByClassName("el-table")[0]&&(this.clientHeight=document.getElementsByClassName("el-table")[0].clientHeight,document.getElementsByClassName("el-table__body-wrapper")[0].style.height=`calc(100vh - ${this.clientHeight+143}px)`)},tableMacroRowClassName(a){a.row,a.rowIndex},getEditKeyIndex(a){var t=[];if(t.push(a),"KeyDown"==this.macrodata.TaskList[a].taskName){for(var e=a+1;e<this.macrodata.TaskList.length;e++)if(this.macrodata.TaskList[a].taskValue==this.macrodata.TaskList[e].taskValue&&this.macrodata.TaskList[a].taskName!=this.macrodata.TaskList[e].taskName){t.push(e);break}}else if("KeyUp"==this.macrodata.TaskList[a].taskName)for(e=a-1;e>=0;e--)if(this.macrodata.TaskList[a].taskValue==this.macrodata.TaskList[e].taskValue&&this.macrodata.TaskList[a].taskName!=this.macrodata.TaskList[e].taskName){t.push(e);break}return t},editMacroItem(a){var t=this;this.editidx=[],this.editidx=this.getEditKeyIndex(a),window.startRecord(),window.parent.onKeyDown((function(e){e[0]&&(t.macrodata.TaskList[a].taskValue=e[0],t.macrodata.TaskList[t.editidx[1]].taskValue=e[0]),window.stopRecord(),t.editidx=[]}))},formatDelay(a){var t=new RegExp("^[1-9]([0-9])*$").test(a.target.value);t||(a.target.value=10)},delMacroItem(a){var t=this,e=this.getEditKeyIndex(a);e.sort().reverse().forEach((function(a){t.macrodata.TaskList.splice(a,1)})),this.editidx=[],window.stopRecord()},initMacroData(){this.isrecording&&(this.isrecording=!1,this.recordingicon="el-icon-video-play",this.recordingtype="default",this.stopMacroRecord(),window.stopRecord()),this.ismacrodatachange=!1,this.isMacroEditing=!1,this.editidx=[],this.macrodataorg=JSON.parse(JSON.stringify(this.macrodata))},initMacroCateSelect(a){CMS.macros&&CMS.macros[a]&&CMS.macros[a].Data?(this.macrocatesel=a,this.macrosel=0,this.submacros=CMS.macros[a].Data,this.macrodata.TaskList=CMS.macros[a].Data,this.$refs.macrocatetable.setCurrentRow(CMS.macros[a])):(this.macrocatesel=null,this.macrosel=null,this.submacros=[],this.macrodata.TaskList=[],this.$refs.macrocatetable&&this.$refs.macrocatetable.setCurrentRow(null),console.warn("The selected macro category does not exist or has no data."))},tableRowClassName(a){var t=a.row,e=a.rowIndex;t.index=e},handleRowChange(a,t,e){this.macrocatesel=a.index,this.macrosel=0,0==a.Data.length&&(a.Data=[]),this.submacros=a.Data},addMacroCate(){var a=this;if(a.newmacrocate.Name){for(var t=!1,e=0;e<CMS.macros.length;e++)CMS.macros[e].Name==a.newmacrocate.Name&&(t=!0);t?a.alertInfo(a.$t("macro.macro_cate_already_exist"),"warning",1e3):(a.macrolist.push(JSON.parse(JSON.stringify(a.newmacrocate))),window.writeMacroList(CMS.macros,(function(t){a.alertInfo(a.$t("macro.macro_cate_create")+a.newmacrocate.Name+a.$t("common.success"),"success",1e3)})),a.$nextTick((function(){a.$refs.macrocatetable.bodyWrapper.scrollTop=a.$refs.macrocatetable.bodyWrapper.scrollHeight,a.initMacroCateSelect(CMS.macros.length-1)})))}else a.alertInfo(a.$t("macro.macro_cate_name_cannot_empty"),"error",1e3)},handleCloseDialog(){this.dialog.visible=!1},handleConfirm(){var a=this;if(1==a.dialog.dtype)for(var t=0;t<CMS.macros.length;t++)if(CMS.macros[t].Name==a.macrolist[a.macrocatesel].Name){var e=0;e=t==CMS.macros.length-1?CMS.macros.length-2:t,CMS.macros.splice(t,1),window.writeMacroList(CMS.macros,(function(t){a.alertInfo(a.$t("macro.macro_cate_delete")+a.macrolist[a.macrocatesel].Name+a.$t("common.success"),"success",1e3)})),a.$nextTick((function(){a.initMacroCateSelect(e)}))}a.dialog.visible=!1},deleteMacroCate(){var a=this;a.dialog.title=a.$t("common.attention"),a.dialog.content=a.$t("macro.macro_cate_delete_confirm_info"),a.dialog.dtype=1,a.dialog.visible=!0},handleSelectMacro(a){var t=this;if(t.macrolist&&t.macrolist[t.macrocatesel]&&0!==t.macrolist[t.macrocatesel].Data.length){t.macrosel!==a&&(t.macrosel=a);var e=t.macrolist[t.macrocatesel].Data[t.macrosel];e&&e.GUID&&window.readMacroFile(e.GUID,(function(a){null===a.TaskList&&(a.TaskList=[]),t.macrodata=a,t.macrodata.TaskList.length,t.initMacroData()}))}},openAddMacroDialog(){},addMacro(){var a=this;if(this.newmacro.Name){var t=this.macrolist[this.macrocatesel];if(t&&t.Data){for(var e=!1,o=0;o<t.Data.length;o++)if(t.Data[o].Name===this.newmacro.Name){e=!0;break}if(e)return void this.alertInfo(this.$t("macro.macro_files_no_repeat"),"warning",1e3)}else this.alertInfo(this.$t("macro.macro_no_cate"),"warning",500);if(this.macrolist&&null!=this.macrocatesel&&this.macrolist[this.macrocatesel]&&this.macrolist[this.macrocatesel].Data){a.newmacro.GUID=window.getGuid();var r={MacroName:a.newmacro.Name,GUID:a.newmacro.GUID,TaskList:[]};a.submacros.push(JSON.parse(JSON.stringify(a.newmacro))),window.parent.writeMacroFile(a.newmacro.GUID,r,(function(){window.parent.writeMacroList(CMS.macros,(function(){a.alertInfo(a.$t("macro.macro_create")+a.$t("common.success"),"success",500)}))}))}else this.alertInfo(this.$t("macro.macro_no_cate"),"warning",500)}else this.alertInfo(this.$t("macro.macro_item_empty"),"warning",500)},copyMacro(){var a=this;if(a.macrolist&&null!=a.macrocatesel&&a.macrolist[a.macrocatesel]&&null!=a.macrosel&&a.macrolist[a.macrocatesel].Data&&a.macrolist[a.macrocatesel].Data[a.macrosel]){a.newmacro.GUID=window.getGuid(),a.newmacro.Name=a.macrolist[a.macrocatesel].Data[a.macrosel].Name+a.$t("common.copy");var t={MacroName:a.macrolist[a.macrocatesel].Data[a.macrosel].Name+a.$t("common.copy"),GUID:a.newmacro.GUID,TaskList:JSON.parse(JSON.stringify(a.macrodata.TaskList))};a.submacros.push(JSON.parse(JSON.stringify(a.newmacro))),window.writeMacroFile(a.newmacro.GUID,t,(function(){window.writeMacroList(CMS.macros,(function(){a.alertInfo(a.$t("macro.macro_copy")+a.$t("common.success"),"success",500),a.handleSelectMacro(a.macrolist[a.macrocatesel].Data.length-1)}))}))}else console.warn("The selected macro or its data is not available."),a.alertInfo(a.$t("macro.macro_copy")+a.$t("common.failed"),"error",500)},deleteMacro(){var a=this;if(a.macrolist&&null!=a.macrocatesel&&a.macrolist[a.macrocatesel]&&a.macrolist[a.macrocatesel].Data&&0!=a.macrolist[a.macrocatesel].Data.length){var t=JSON.parse(JSON.stringify(a.macrolist[a.macrocatesel].Data[a.macrosel]));window.deleteMacrofile(t.GUID,(function(){a.macrolist[a.macrocatesel].Data.length>1&&a.macrolist[a.macrocatesel].Data.length-1==a.macrosel?(a.macrosel-=1,a.submacros.splice(a.macrosel+1,1)):1==a.macrolist[a.macrocatesel].Data.length?(a.macrosel=0,a.submacros.splice(a.macrosel,1)):a.submacros.splice(a.macrosel,1),a.handleSelectMacro(a.macrosel),window.writeMacroList(CMS.macros,(function(){a.alertInfo(a.$t("macro.macro_delete")+a.$t("common.success"),"success",500)}))}))}else a.alertInfo(a.$t("macro.macro_no_select"),"warning",500)},alertInfo:function(a,t,e){this.$notify({title:a,type:t,duration:e,position:"bottom-left"})},onKeyResponse(){var a=this;a.$t("macro.macro_left_down"),a.$t("macro.macro_left_up"),a.$t("macro.macro_right_down"),a.$t("macro.macro_right_up");window.parent.onKeyDown((function(t){var e={taskName:"KeyDown",taskValue:t[0]};switch(a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}})),window.parent.onKeyUp((function(t){var e={taskName:"KeyUp",taskValue:t[0]};switch(a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}})),window.parent.onDelay((function(t){t[0]=parseInt(t[0])<5?"5":t[0];var e={taskName:"Delay",taskValue:0};switch(1==a.macro_delay_type?e.taskValue=t[0]:2==a.macro_delay_type?e.taskValue=5:3==a.macro_delay_type&&(e.taskValue=a.macro_delay_time),a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}})),window.parent.onMouseDown((function(t){var e={taskName:"LeftDown",taskValue:""};if(0==t[0])switch(e.taskName="LeftDown",a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}else switch(e.taskName="RightDown",a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}})),window.parent.onMouseUp((function(t){var e={taskName:"LeftUp",taskValue:""};if(0==t[0])switch(e.taskName="LeftUp",a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}else switch(e.taskName="RightUp",a.mode){case"new":a.macrodata.TaskList.push(e);break;case"edit":return a.macrodata.TaskList.push(e),!1;case"before":a.macrodata.TaskList.push(e);break;case"after":a.macrodata.TaskList.push(e);break}}))},startMacroRecord(){var a=this;a.macrodata.TaskList&&a.macrodata.TaskList.length>0?(a.macrodata.TaskList.push(JSON.parse(JSON.stringify({taskName:"Delay",taskValue:a.macro_delay_time}))),a.$confirm(a.$t("macro.macro_rerecord_confirm"),a.$t("common.attention"),{confirmButtonText:a.$t("macro.macro_continue_record"),cancelButtonText:a.$t("macro.macro_clear_record"),center:!0,type:"warning"}).then((function(){window.startRecord(),a.onKeyResponse()})).catch((function(){a.macrodata.TaskList=[],window.startRecord(),a.onKeyResponse()}))):(window.startRecord(),a.onKeyResponse())},stopMacroRecord(){var a=this;window.stopRecord(),a.ismacrodatachange=!0},switchMacroRecord(){var a=this;a.isrecording?(a.isrecording=!1,a.recordingicon="el-icon-video-play",a.recordingtype="default",a.stopMacroRecord()):(a.isrecording=!0,a.recordingicon="el-icon-video-pause",a.recordingtype="success",a.isMacroEditing=!0,a.startMacroRecord())},changeMacroName(a){var t=this;if(this.macrolist.length>0&&this.macrolist[this.macrocatesel].Data.length>0){var e=this.macrolist[this.macrocatesel].Data[this.macrosel];e?(this.$set(e,"Name",a),window.writeMacroList(this.macrolist,(function(a){t.alertInfo(t.$t("macro.macro_rename")+t.$t("common.success"),"success",500)}))):console.warn("No macro selected. Cannot change macro name.")}},recordBtnEnter(a){var t=this;t.isrecording&&window.parent.listenStopMakeMacro(!0)},recordBtnLeave(a){var t=this;t.isrecording&&window.parent.listenStopMakeMacro(!1)},editMacroData(){this.isMacroEditing=!0},deleteMacroData(){},moveUpMacroData(a){this.$emit("up",this.index);var t=this.macrolist[a-1];Vue.set(this.macrolist,a-1,this.macrolist[a]),Vue.set(this.macrolist,a,t)},moveDownMacroData(){this.$emit("down",this.index);var a=this.macrolist[index+1];Vue.set(this.macrolist,index+1,this.macrolist[index]),Vue.set(this.macrolist,index,a)},insertMacroData(){},cancelMacroData(){var a=this;window.readMacroFile(a.macrodata.GUID,(function(t){a.macrodata.TaskList=t.TaskList?t.TaskList:[],a.initMacroData()}))},saveMacroData(){var a=this;window.writeMacroFile(a.macrodata.GUID,a.macrodata,(function(t){a.alertInfo(a.$t("macro.macro_save")+a.$t("common.success"),"success",500),a.initMacroData()}))},exportMacroFile(){var a=this;if(a.macrolist&&null!=a.macrocatesel&&a.macrolist[a.macrocatesel]&&a.macrolist[a.macrocatesel].Data&&0!=a.macrolist[a.macrocatesel].Data.length&&null!=a.macrosel&&a.macrolist[a.macrocatesel].Data[a.macrosel]){var t=a.macrolist[a.macrocatesel].Data[a.macrosel];t.GUID?window.readMacroFile(t.GUID,(function(t){window.exportMacro(a.macrodata,(function(t){a.alertInfo(a.$t("macro.macro_export")+a.$t("common.success"),"success",500)}))})):a.alertInfo(a.$t("macro.macro_export")+a.$t("common.fail"),"danger",500)}else a.alertInfo(a.$t("macro.macro_export")+a.$t("common.fail"),"danger",500)},importMacroFile(){var a=this,t=window.getGuid();window.importMacro((function(e){var o=JSON.parse(e);o.GUID=t,window.writeMacroFile(o.GUID,o,(function(t){a.newmacro.Name=o.MacroName,a.newmacro.GUID=o.GUID;try{if(!a.macrolist||!a.macrolist[a.macrocatesel]||!a.macrolist[a.macrocatesel].Data)throw new Error("Failed to find macro category or its data.");a.macrolist[a.macrocatesel].Data.push(JSON.parse(JSON.stringify(a.newmacro))),window.writeMacroList(a.macrolist,(function(t){a.alertInfo(a.$t("macro.macro_import")+a.$t("common.success"),"success",1e3),a.handleSelectMacro(a.macrolist[a.macrocatesel].Data.length-1)}))}catch(e){console.error("Import failed:",e),a.alertInfo(a.$t("macro.macro_import")+a.$t("common.fail"),"danger",1e3)}}))}),(function(t){console.error("Call CMS failure!",t),a.alertInfo(a.$t("macro.macro_import")+a.$t("common.fail"),"danger",1e3)}))}},beforeRouteEnter(a,t,e){CMS.isLoaded=!1,setTimeout((function(){e((function(a){setTimeout((function(){CMS.isLoaded=!0}),500)}))}),5)}},n=i,l=(e(46167),e(14486)),m=(0,l.A)(n,o,r,!1,null,"23cf8032",null),d=m.exports},46167:function(a,t,e){var o=e(32703);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[a.id,o,""]]),o.locals&&(a.exports=o.locals);var r=e(70534).A;r("8c77f358",o,!0,{})},74488:function(a,t,e){"use strict";var o=e(67680),r=Math.floor,c=function(a,t){var e=a.length;if(e<8){var s,i,n=1;while(n<e){i=n,s=a[n];while(i&&t(a[i-1],s)>0)a[i]=a[--i];i!==n++&&(a[i]=s)}}else{var l=r(e/2),m=c(o(a,0,l),t),d=c(o(a,l),t),u=m.length,h=d.length,f=0,p=0;while(f<u||p<h)a[f+p]=f<u&&p<h?t(m[f],d[p])<=0?m[f++]:d[p++]:f<u?m[f++]:d[p++]}return a};a.exports=c},28834:function(a,t,e){"use strict";var o=e(79392),r=o.match(/firefox\/(\d+)/i);a.exports=!!r&&+r[1]},63202:function(a,t,e){"use strict";var o=e(79392);a.exports=/MSIE|Trident/.test(o)},89160:function(a,t,e){"use strict";var o=e(79392),r=o.match(/AppleWebKit\/(\d+)\./);a.exports=!!r&&+r[1]},26910:function(a,t,e){"use strict";var o=e(46518),r=e(79504),c=e(79306),s=e(48981),i=e(26198),n=e(84606),l=e(655),m=e(79039),d=e(74488),u=e(34598),h=e(28834),f=e(63202),p=e(77388),w=e(89160),g=[],_=r(g.sort),k=r(g.push),v=m((function(){g.sort(void 0)})),y=m((function(){g.sort(null)})),b=u("sort"),M=!m((function(){if(p)return p<70;if(!(h&&h>3)){if(f)return!0;if(w)return w<603;var a,t,e,o,r="";for(a=65;a<76;a++){switch(t=String.fromCharCode(a),a){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(o=0;o<47;o++)g.push({k:t+o,v:e})}for(g.sort((function(a,t){return t.v-a.v})),o=0;o<g.length;o++)t=g[o].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}})),x=v||!y||!b||!M,N=function(a){return function(t,e){return void 0===e?-1:void 0===t?1:void 0!==a?+a(t,e)||0:l(t)>l(e)?1:-1}};o({target:"Array",proto:!0,forced:x},{sort:function(a){void 0!==a&&c(a);var t=s(this);if(M)return void 0===a?_(t):_(t,a);var e,o,r=[],l=i(t);for(o=0;o<l;o++)o in t&&k(r,t[o]);d(r,N(a)),e=i(r),o=0;while(o<e)t[o]=r[o++];while(o<l)n(t,o++);return t}})}}]);